{"version":3,"sources":["webpack:///./src/components/dialog/ha-iron-focusables-helper.js","webpack:///./src/components/dialog/ha-paper-dialog.ts","webpack:///./src/panels/config/area_registry/dialog-area-registry-detail.ts"],"names":["HaIronFocusablesHelper","getTabbableNodes","node","result","this","_collectTabbableNodes","_sortByTabIndex","nodeType","Node","ELEMENT_NODE","_isVisible","children","element","tabIndex","_normalizedTabIndex","needsSort","push","localName","getDistributedNodes","shadowRoot","root","i","length","paperDialogClass","customElements","get","haTabFixBehaviorImpl","define","_error","_name","_params","showDialog","params","undefined","entry","name","updateComplete","render","nameInvalid","trim","_openedChanged","hass","localize","area_id","_nameChanged","_deleteEntry","_submitting","_updateEntry","ev","detail","value","values","updateEntry","createEntry","message","removeEntry","DialogAreaDetail"],"mappings":"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","file":"chunk.25b8d4ef1fba5ae77921.js","sourcesContent":["/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at\nhttp://polymer.github.io/LICENSE.txt The complete set of authors may be found at\nhttp://polymer.github.io/AUTHORS.txt The complete set of contributors may be\nfound at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as\npart of the polymer project is also subject to an additional IP rights grant\nfound at http://polymer.github.io/PATENTS.txt\n*/\n/*\n  Fixes issue with not using shadow dom properly in iron-overlay-behavior/icon-focusables-helper.js\n*/\nimport { dom } from \"@polymer/polymer/lib/legacy/polymer.dom.js\";\n\nimport { IronFocusablesHelper } from \"@polymer/iron-overlay-behavior/iron-focusables-helper.js\";\n\nexport const HaIronFocusablesHelper = {\n  /**\n   * Returns a sorted array of tabbable nodes, including the root node.\n   * It searches the tabbable nodes in the light and shadow dom of the chidren,\n   * sorting the result by tabindex.\n   * @param {!Node} node\n   * @return {!Array<!HTMLElement>}\n   */\n  getTabbableNodes: function(node) {\n    var result = [];\n    // If there is at least one element with tabindex > 0, we need to sort\n    // the final array by tabindex.\n    var needsSortByTabIndex = this._collectTabbableNodes(node, result);\n    if (needsSortByTabIndex) {\n      return IronFocusablesHelper._sortByTabIndex(result);\n    }\n    return result;\n  },\n\n  /**\n   * Searches for nodes that are tabbable and adds them to the `result` array.\n   * Returns if the `result` array needs to be sorted by tabindex.\n   * @param {!Node} node The starting point for the search; added to `result`\n   * if tabbable.\n   * @param {!Array<!HTMLElement>} result\n   * @return {boolean}\n   * @private\n   */\n  _collectTabbableNodes: function(node, result) {\n    // If not an element or not visible, no need to explore children.\n    if (\n      node.nodeType !== Node.ELEMENT_NODE ||\n      !IronFocusablesHelper._isVisible(node)\n    ) {\n      return false;\n    }\n    var element = /** @type {!HTMLElement} */ (node);\n    var tabIndex = IronFocusablesHelper._normalizedTabIndex(element);\n    var needsSort = tabIndex > 0;\n    if (tabIndex >= 0) {\n      result.push(element);\n    }\n\n    // In ShadowDOM v1, tab order is affected by the order of distrubution.\n    // E.g. getTabbableNodes(#root) in ShadowDOM v1 should return [#A, #B];\n    // in ShadowDOM v0 tab order is not affected by the distrubution order,\n    // in fact getTabbableNodes(#root) returns [#B, #A].\n    //  <div id=\"root\">\n    //   <!-- shadow -->\n    //     <slot name=\"a\">\n    //     <slot name=\"b\">\n    //   <!-- /shadow -->\n    //   <input id=\"A\" slot=\"a\">\n    //   <input id=\"B\" slot=\"b\" tabindex=\"1\">\n    //  </div>\n    // TODO(valdrin) support ShadowDOM v1 when upgrading to Polymer v2.0.\n    var children;\n    if (element.localName === \"content\" || element.localName === \"slot\") {\n      children = dom(element).getDistributedNodes();\n    } else {\n      // /////////////////////////\n      // Use shadow root if possible, will check for distributed nodes.\n      // THIS IS THE CHANGED LINE\n      children = dom(element.shadowRoot || element.root || element).children;\n      // /////////////////////////\n    }\n    for (var i = 0; i < children.length; i++) {\n      // Ensure method is always invoked to collect tabbable children.\n      needsSort = this._collectTabbableNodes(children[i], result) || needsSort;\n    }\n    return needsSort;\n  },\n};\n","import \"@polymer/paper-dialog/paper-dialog\";\nimport { mixinBehaviors } from \"@polymer/polymer/lib/legacy/class\";\nimport { HaIronFocusablesHelper } from \"./ha-iron-focusables-helper.js\";\n// tslint:disable-next-line\nimport { PaperDialogElement } from \"@polymer/paper-dialog/paper-dialog\";\n\nconst paperDialogClass = customElements.get(\"paper-dialog\");\n\n// behavior that will override existing iron-overlay-behavior and call the fixed implementation\nconst haTabFixBehaviorImpl = {\n  get _focusableNodes() {\n    return HaIronFocusablesHelper.getTabbableNodes(this);\n  },\n};\n\n// paper-dialog that uses the haTabFixBehaviorImpl behvaior\n// export class HaPaperDialog extends paperDialogClass {}\n// @ts-ignore\nexport class HaPaperDialog\n  extends mixinBehaviors([haTabFixBehaviorImpl], paperDialogClass)\n  implements PaperDialogElement {}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-paper-dialog\": HaPaperDialog;\n  }\n}\ncustomElements.define(\"ha-paper-dialog\", HaPaperDialog);\n","import {\n  LitElement,\n  html,\n  css,\n  PropertyDeclarations,\n  CSSResult,\n  TemplateResult,\n} from \"lit-element\";\nimport \"@polymer/paper-dialog-scrollable/paper-dialog-scrollable\";\nimport \"@polymer/paper-input/paper-input\";\n\nimport \"../../../components/dialog/ha-paper-dialog\";\nimport { AreaRegistryDetailDialogParams } from \"./show-dialog-area-registry-detail\";\nimport { PolymerChangedEvent } from \"../../../polymer-types\";\nimport { haStyleDialog } from \"../../../resources/styles\";\nimport { HomeAssistant } from \"../../../types\";\nimport { AreaRegistryEntryMutableParams } from \"../../../data/area_registry\";\n\nclass DialogAreaDetail extends LitElement {\n  public hass!: HomeAssistant;\n  private _name!: string;\n  private _error?: string;\n  private _params?: AreaRegistryDetailDialogParams;\n  private _submitting?: boolean;\n\n  static get properties(): PropertyDeclarations {\n    return {\n      _error: {},\n      _name: {},\n      _params: {},\n    };\n  }\n\n  public async showDialog(\n    params: AreaRegistryDetailDialogParams\n  ): Promise<void> {\n    this._params = params;\n    this._error = undefined;\n    this._name = this._params.entry ? this._params.entry.name : \"\";\n    await this.updateComplete;\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._params) {\n      return html``;\n    }\n    const entry = this._params.entry;\n    const nameInvalid = this._name.trim() === \"\";\n    return html`\n      <ha-paper-dialog\n        with-backdrop\n        opened\n        @opened-changed=\"${this._openedChanged}\"\n      >\n        <h2>\n          ${entry\n            ? entry.name\n            : this.hass.localize(\n                \"ui.panel.config.area_registry.editor.default_name\"\n              )}\n        </h2>\n        <paper-dialog-scrollable>\n          ${this._error\n            ? html`\n                <div class=\"error\">${this._error}</div>\n              `\n            : \"\"}\n          <div class=\"form\">\n            ${entry\n              ? html`\n                  <div>Area ID: ${entry.area_id}</div>\n                `\n              : \"\"}\n\n            <paper-input\n              .value=${this._name}\n              @value-changed=${this._nameChanged}\n              label=\"Name\"\n              error-message=\"Name is required\"\n              .invalid=${nameInvalid}\n            ></paper-input>\n          </div>\n        </paper-dialog-scrollable>\n        <div class=\"paper-dialog-buttons\">\n          ${entry\n            ? html`\n                <mwc-button\n                  class=\"warning\"\n                  @click=\"${this._deleteEntry}\"\n                  .disabled=${this._submitting}\n                >\n                  ${this.hass.localize(\n                    \"ui.panel.config.area_registry.editor.delete\"\n                  )}\n                </mwc-button>\n              `\n            : html``}\n          <mwc-button\n            @click=\"${this._updateEntry}\"\n            .disabled=${nameInvalid || this._submitting}\n          >\n            ${entry\n              ? this.hass.localize(\n                  \"ui.panel.config.area_registry.editor.update\"\n                )\n              : this.hass.localize(\n                  \"ui.panel.config.area_registry.editor.create\"\n                )}\n          </mwc-button>\n        </div>\n      </ha-paper-dialog>\n    `;\n  }\n\n  private _nameChanged(ev: PolymerChangedEvent<string>) {\n    this._error = undefined;\n    this._name = ev.detail.value;\n  }\n\n  private async _updateEntry() {\n    this._submitting = true;\n    try {\n      const values: AreaRegistryEntryMutableParams = {\n        name: this._name.trim(),\n      };\n      if (this._params!.entry) {\n        await this._params!.updateEntry(values);\n      } else {\n        await this._params!.createEntry(values);\n      }\n      this._params = undefined;\n    } catch (err) {\n      this._error = err.message || \"Unknown error\";\n    } finally {\n      this._submitting = false;\n    }\n  }\n\n  private async _deleteEntry() {\n    this._submitting = true;\n    try {\n      if (await this._params!.removeEntry()) {\n        this._params = undefined;\n      }\n    } finally {\n      this._submitting = false;\n    }\n  }\n\n  private _openedChanged(ev: PolymerChangedEvent<boolean>): void {\n    if (!(ev.detail as any).value) {\n      this._params = undefined;\n    }\n  }\n\n  static get styles(): CSSResult[] {\n    return [\n      haStyleDialog,\n      css`\n        ha-paper-dialog {\n          min-width: 400px;\n        }\n        .form {\n          padding-bottom: 24px;\n        }\n        mwc-button.warning {\n          margin-right: auto;\n        }\n        .error {\n          color: var(--google-red-500);\n        }\n      `,\n    ];\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"dialog-area-registry-detail\": DialogAreaDetail;\n  }\n}\n\ncustomElements.define(\"dialog-area-registry-detail\", DialogAreaDetail);\n"],"sourceRoot":""}